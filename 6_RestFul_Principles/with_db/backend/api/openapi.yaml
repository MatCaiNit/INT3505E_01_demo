openapi: 3.0.3
info:
  description: |
    API mô tả hệ thống sản phẩm của một nhà sách online (Design-First).   Bao gồm CRUD cho sản phẩm, danh mục, và hiển thị danh sách sản phẩm.
  title: Bookstore Product API
  version: 1.0.0
servers:
- description: Local Flask Server
  url: http://localhost:5000/
tags:
- description: "Xác thực người dùng (đăng ký, đăng nhập)"
  name: Auth
- description: "Quản lý sản phẩm (sách, đồ chơi, văn phòng phẩm, ...)"
  name: Product
- description: Danh mục sản phẩm
  name: Category
paths:
  /register:
    post:
      operationId: register
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
          description: Đăng ký thành công
        "400":
          description: Dữ liệu không hợp lệ (username hoặc password thiếu)
        "409":
          description: Tài khoản đã tồn tại
      summary: Đăng ký tài khoản người dùng mới
      tags:
      - Auth
      x-eov-operation-handler: authController
  /login:
    post:
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
          description: Đăng nhập thành công
        "401":
          description: Sai tên đăng nhập hoặc mật khẩu
      summary: Đăng nhập vào hệ thống
      tags:
      - Auth
      x-eov-operation-handler: authController
  /products:
    get:
      operationId: productsGET
      parameters:
      - description: Lọc sản phẩm theo danh mục
        explode: true
        in: query
        name: category
        required: false
        schema:
          type: string
        style: form
      - description: Lọc theo loại sản phẩm
        explode: true
        in: query
        name: type
        required: false
        schema:
          enum:
          - book
          - toy
          - office_supply
          type: string
        style: form
      - explode: true
        in: query
        name: limit
        required: false
        schema:
          default: 20
          type: integer
        style: form
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/Product"
                type: array
          description: Danh sách sản phẩm
      summary: Lấy danh sách tất cả sản phẩm
      tags:
      - Product
      x-eov-operation-handler: ProductController
    post:
      operationId: productsPOST
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProductCreate"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Product"
          description: Sản phẩm được tạo thành công
        "403":
          description: Không có quyền truy cập
      security:
      - bearerAuth: []
      summary: (Admin) Tạo mới sản phẩm
      tags:
      - Product
      x-eov-operation-handler: ProductController
  /products/{id}:
    delete:
      operationId: productsIdDELETE
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: string
        style: simple
      responses:
        "204":
          description: Xóa thành công
        "404":
          description: Không tìm thấy sản phẩm
        "403":
          description: Không có quyền
      security:
      - bearerAuth: []
      summary: (Admin) Xóa sản phẩm
      tags:
      - Product
      x-eov-operation-handler: ProductController
    get:
      operationId: productsIdGET
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: string
        style: simple
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Product"
          description: Thông tin chi tiết sản phẩm
        "404":
          description: Không tìm thấy sản phẩm
      summary: Lấy chi tiết một sản phẩm
      tags:
      - Product
      x-eov-operation-handler: ProductController
    put:
      operationId: productsIdPUT
      parameters:
      - explode: false
        in: path
        name: id
        required: true
        schema:
          type: string
        style: simple
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProductUpdate"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Product"
          description: Cập nhật thành công
        "404":
          description: Không tìm thấy sản phẩm
        "403":
          description: Không có quyền
      security:
      - bearerAuth: []
      summary: (Admin) Cập nhật thông tin sản phẩm
      tags:
      - Product
      x-eov-operation-handler: ProductController
  /categories:
    get:
      operationId: categoriesGET
      responses:
        "200":
          content:
            application/json:
              schema:
                items:
                  $ref: "#/components/schemas/Category"
                type: array
          description: Danh sách danh mục
      summary: Lấy danh sách danh mục sản phẩm
      tags:
      - Category
      x-eov-operation-handler: CategoryController
components:
  schemas:
    RegisterRequest:
      example:
        password: "123456"
        fullName: Nguyễn Mạnh Quỳnh
        email: quynh@example.com
        username: nguyenmanhquynh
      properties:
        username:
          example: nguyenmanhquynh
          type: string
        password:
          example: "123456"
          format: password
          type: string
        email:
          example: quynh@example.com
          type: string
        fullName:
          example: Nguyễn Mạnh Quỳnh
          type: string
      required:
      - password
      - username
      type: object
    LoginRequest:
      example:
        password: "123456"
        username: nguyenmanhquynh
      properties:
        username:
          example: nguyenmanhquynh
          type: string
        password:
          example: "123456"
          format: password
          type: string
      required:
      - password
      - username
      type: object
    AuthResponse:
      example:
        message: Login successful
        token: eyJhbGciOiJIUzI1NiIsInR5...
      properties:
        message:
          example: Login successful
          type: string
        token:
          example: eyJhbGciOiJIUzI1NiIsInR5...
          type: string
      type: object
    Product:
      example:
        images:
        - https://example.com/images/dacnhantam.jpg
        - https://example.com/images/dacnhantam.jpg
        author: Dale Carnegie
        discount: 10
        description: Cuốn sách kinh điển về nghệ thuật giao tiếp.
        weight: weight
        language: Tiếng Việt
        type: book
        age_range: age_range
        createdAt: 2000-01-23T04:56:07.000+00:00
        material: material
        size: size
        price: 135000
        name: Đắc Nhân Tâm
        publisher: NXB Trẻ
        id: p123
        category: Tâm lý kỹ năng
        stock: 50
        brand: brand
        updatedAt: 2000-01-23T04:56:07.000+00:00
      properties:
        id:
          example: p123
          type: string
        name:
          example: Đắc Nhân Tâm
          type: string
        category:
          example: Tâm lý kỹ năng
          type: string
        type:
          example: book
          type: string
        price:
          example: 135000
          type: number
        discount:
          example: 10
          type: number
        stock:
          example: 50
          type: integer
        description:
          example: Cuốn sách kinh điển về nghệ thuật giao tiếp.
          type: string
        images:
          items:
            example: https://example.com/images/dacnhantam.jpg
            type: string
          type: array
        author:
          example: Dale Carnegie
          type: string
        publisher:
          example: NXB Trẻ
          type: string
        language:
          example: Tiếng Việt
          type: string
        brand:
          type: string
        material:
          type: string
        size:
          type: string
        weight:
          type: string
        age_range:
          type: string
        createdAt:
          format: date-time
          type: string
        updatedAt:
          format: date-time
          type: string
      type: object
    ProductCreate:
      example:
        images:
        - images
        - images
        author: author
        discount: 1.4658129805029452
        description: description
        weight: weight
        language: language
        type: book
        age_range: age_range
        material: material
        size: size
        price: 0.8008281904610115
        name: name
        publisher: publisher
        category: category
        stock: 6
        brand: brand
      properties:
        name:
          type: string
        category:
          type: string
        type:
          enum:
          - book
          - toy
          - office_supply
          type: string
        price:
          type: number
        stock:
          default: 0
          type: integer
        discount:
          default: 0
          type: number
        description:
          type: string
        images:
          items:
            type: string
          type: array
        author:
          type: string
        publisher:
          type: string
        language:
          type: string
        brand:
          type: string
        material:
          type: string
        size:
          type: string
        weight:
          type: string
        age_range:
          type: string
      required:
      - category
      - name
      - price
      - type
      type: object
    ProductUpdate:
      example:
        age_range: age_range
        images:
        - images
        - images
        material: material
        size: size
        price: 0.8008281904610115
        name: name
        discount: 1.4658129805029452
        description: description
        weight: weight
        stock: 6
        brand: brand
      properties:
        name:
          type: string
        price:
          type: number
        stock:
          type: integer
        discount:
          type: number
        description:
          type: string
        images:
          items:
            type: string
          type: array
        brand:
          type: string
        material:
          type: string
        size:
          type: string
        weight:
          type: string
        age_range:
          type: string
      type: object
    Category:
      example:
        name: Văn học
        id: c01
      properties:
        id:
          example: c01
          type: string
        name:
          example: Văn học
          type: string
      type: object
  securitySchemes:
    bearerAuth:
      bearerFormat: JWT
      scheme: bearer
      type: http
